# Configuração Spring Boot 3.x com R2DBC PostgreSQL

spring:
  application:
    name: wisevra-app
    
  # R2DBC Configuration (Reactive Database)
  r2dbc:
    url: r2dbc:postgresql://ep-nameless-mountain-ahahq1ak-pooler.c-3.us-east-1.aws.neon.tech:5432/neondb?sslmode=require
    username: neondb_owner
    password: npg_WqRuNmy1B9GK
    pool:
      initial-size: 5
      max-size: 10
      max-idle-time: 5m
      validation-query: SELECT 1
      
  # JPA/Hibernate (para migrations/tools se necessário)
  datasource:
    url: jdbc:postgresql://ep-nameless-mountain-ahahq1ak-pooler.c-3.us-east-1.aws.neon.tech:5432/neondb?sslmode=require
    username: neondb_owner
    password: npg_WqRuNmy1B9GK
    driver-class-name: org.postgresql.Driver
    
  # SQL Initialization  
  sql:
    init:
      mode: never
      
  # Flyway Configuration
  flyway:
    enabled: true
    baseline-on-migrate: true
    baseline-version: 1
    validate-on-migrate: true
    out-of-order: false
    locations: classpath:db/migration
    sql-migration-suffixes: .sql
    repeatable-sql-migration-prefix: R
    sql-migration-prefix: V
    sql-migration-separator: __
    table: flyway_schema_history
    clean-disabled: true
    url: jdbc:postgresql://ep-nameless-mountain-ahahq1ak-pooler.c-3.us-east-1.aws.neon.tech:5432/neondb?sslmode=require
    user: neondb_owner
    password: npg_WqRuNmy1B9GK

# Server Configuration
server:
  port: 8080
  error:
    include-message: always
    include-binding-errors: always

# Logging Configuration
logging:
  level:
    "[com.wisevra]": DEBUG
    "[io.r2dbc.postgresql]": DEBUG
    "[org.springframework.data.r2dbc]": DEBUG
    "[org.springframework.web.reactive]": INFO
    "[reactor.netty]": INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
  file:
    name: logs/wisevra-app.log

# Management & Monitoring (Spring Boot Actuator)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always

# Clerk Configuration
clerk:
  webhook:
    secret: whsec_X7LtmB4Og1TXiO8b+O8tBoaR7tL+u+Yt


# OpenTelemetry Configuration
otel:
  exporter:
    otlp:
      endpoint: http://localhost:4317
  resource:
    attributes: service.name=wisevra-app